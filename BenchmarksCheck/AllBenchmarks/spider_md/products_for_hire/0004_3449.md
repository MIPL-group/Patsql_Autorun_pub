# Source: CUBES-spider
## Group: products_for_hire
### ID: 0004

# input:bookings

| booking_id:Int | customer_id:Int | booking_status_code:Str | returned_damaged_yn:Str | booking_start_date:Str | booking_end_date:Str | count_hired:Str | amount_payable:Dbl | amount_of_discount:Dbl | amount_outstanding:Dbl | amount_of_refund:Dbl |
|---|---|---|---|---|---|---|---|---|---|---|
| 1 | 7 | Provisional | 1 | 2016-12-07 23:39:17 | 2018-02-01 16:39:13 | 298 | 214.39 | 71.45 | 28.22 | 179.14 |
| 2 | 15 | Confirmed | 1 | 2017-06-16 11:42:31 | 2018-02-19 21:53:31 | 331 | 386.92 | 83.82 | 57.62 | 183.68 |
| 3 | 3 | Confirmed | 1 | 2017-04-04 11:02:43 | 2018-02-01 09:30:50 | 729 | 351.32 | 49.26 | 66.01 | 135.94 |
| 4 | 7 | Provisional | 0 | 2017-06-05 17:56:01 | 2017-12-02 00:37:00 | 152 | 272.08 | 45.06 | 38.87 | 100.78 |
| 5 | 7 | Provisional | 1 | 2016-11-06 20:54:26 | 2017-10-11 03:00:15 | 546 | 338.1 | 79.34 | 32.99 | 191.31 |
| 6 | 10 | Confirmed | 0 | 2016-06-05 05:18:17 | 2018-01-14 00:29:01 | 282 | 209.41 | 27.78 | 52.62 | 192.02 |
| 7 | 3 | Provisional | 1 | 2017-07-15 06:28:54 | 2017-11-28 08:11:52 | 236 | 322.87 | 39.27 | 56.02 | 126.1 |
| 8 | 11 | Provisional | 0 | 2016-09-26 01:09:20 | 2018-03-24 21:21:32 | 746 | 303.3 | 61.55 | 68.02 | 145.63 |
| 9 | 10 | Provisional | 0 | 2017-05-24 16:16:29 | 2018-03-07 17:39:04 | 846 | 374.59 | 50.93 | 26.04 | 130.87 |
| 10 | 3 | Confirmed | 1 | 2016-05-06 03:50:49 | 2017-08-30 04:33:23 | 857 | 320.73 | 39.16 | 27.81 | 112.63 |
| 11 | 9 | Provisional | 1 | 2017-04-11 00:39:03 | 2017-10-02 07:28:09 | 488 | 273.28 | 48.73 | 73.88 | 181.19 |
| 12 | 3 | Provisional | 1 | 2017-02-27 12:04:35 | 2018-02-06 19:27:09 | 914 | 281.09 | 26.37 | 22.97 | 110.39 |
| 13 | 8 | Provisional | 0 | 2016-11-27 17:19:40 | 2018-03-04 21:42:45 | 499 | 286.47 | 89.05 | 36.79 | 143.99 |
| 14 | 8 | Confirmed | 1 | 2016-04-25 11:04:18 | 2018-01-01 10:19:20 | 843 | 221.57 | 24.19 | 64.01 | 161.9 |
| 15 | 9 | Provisional | 1 | 2017-04-28 08:35:56 | 2018-01-18 23:54:44 | 994 | 306.26 | 78.31 | 93.88 | 124.95 |

# input:payments

| payment_id:Int | booking_id:Int | customer_id:Int | payment_type_code:Str | amount_paid_in_full_yn:Str | payment_date:Str | amount_due:Dbl | amount_paid:Dbl |
|---|---|---|---|---|---|---|---|
| 1 | 6 | 15 | Check | 1 | 2018-03-09 16:28:00 | 369.52 | 206.27 |
| 2 | 9 | 12 | Cash | 1 | 2018-03-03 13:39:44 | 278.6 | 666.45 |
| 3 | 5 | 7 | Credit Card | 0 | 2018-03-22 15:00:23 | 840.06 | 135.7 |
| 4 | 6 | 1 | Check | 0 | 2018-03-22 02:28:11 | 678.29 | 668.4 |
| 5 | 8 | 11 | Cash | 1 | 2018-03-23 20:36:04 | 830.25 | 305.65 |
| 6 | 15 | 8 | Check | 0 | 2018-03-19 12:39:31 | 410.1 | 175.54 |
| 7 | 1 | 8 | Cash | 1 | 2018-03-02 06:25:45 | 482.26 | 602.8 |
| 8 | 9 | 14 | Cash | 1 | 2018-03-12 23:00:55 | 653.18 | 505.23 |
| 9 | 3 | 7 | Direct Debit | 0 | 2018-03-12 23:23:56 | 686.85 | 321.58 |
| 10 | 13 | 10 | Credit Card | 1 | 2018-03-23 13:24:33 | 486.75 | 681.21 |
| 11 | 14 | 15 | Credit Card | 1 | 2018-03-03 03:07:00 | 259.18 | 464.06 |
| 12 | 14 | 9 | Cash | 0 | 2018-02-27 10:50:39 | 785.73 | 685.32 |
| 13 | 15 | 14 | Direct Debit | 0 | 2018-03-03 14:22:51 | 665.58 | 307.14 |
| 14 | 5 | 5 | Direct Debit | 1 | 2018-03-17 15:51:52 | 407.51 | 704.41 |
| 15 | 4 | 12 | Credit Card | 1 | 2018-03-17 03:07:45 | 631.93 | 334.2 |

# constraint

{
  "constants": [
    "1"
  ],
  "aggregation_functions": []
}

# output:0004

| booking_id:Int | amount_of_refund:Dbl |
|---|---|
| 15 | 124.95 |

# solution

```sql
SELECT T1.booking_id,
       T1.amount_of_refund
FROM Bookings AS T1
JOIN Payments AS T2 ON T1.booking_id = T2.booking_id
GROUP BY T1.booking_id
ORDER BY count(*) DESC
LIMIT 1
```
